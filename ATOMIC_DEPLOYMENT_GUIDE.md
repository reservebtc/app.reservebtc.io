# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ê—Ç–æ–º–∞—Ä–Ω–æ–º—É –î–µ–ø–ª–æ—é ReserveBTC

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –≤—Å–µ—Ö —Ç—Ä—ë—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ ReserveBTC —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ `0x1bc2178f (NotOracle)` –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Ç–∏ MegaETH –∏ –≥–æ—Ç–æ–≤ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ Mainnet.

## üéØ –ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏:
- `FeeVault` –Ω—É–∂–µ–Ω –∞–¥—Ä–µ—Å `OracleAggregator` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
- `OracleAggregator` –Ω—É–∂–Ω—ã –∞–¥—Ä–µ—Å–∞ `FeeVault` –∏ `RBTCSynth` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ  
- `RBTCSynth` –Ω—É–∂–µ–Ω –∞–¥—Ä–µ—Å `OracleAggregator` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:** –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–∞–º `NotOracle()` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ Oracle Aggregator –≤—ã–∑–≤–∞—Ç—å `spendFrom()` –Ω–∞ FeeVault.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ê—Ç–æ–º–∞—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º –∞–¥—Ä–µ—Å–æ–≤

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤:** –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º—É–ª—É `CREATE` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±—É–¥—É—â–∏—Ö –∞–¥—Ä–µ—Å–æ–≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ nonce –¥–µ–ø–ª–æ–µ—Ä–∞
2. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π:** –î–µ–ø–ª–æ–∏–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞
3. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–æ–≤–ø–∞–ª–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏

### –°–∫—Ä–∏–ø—Ç: AtomicDeployFixed.s.sol

```solidity
// STEP 1: –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –∞–¥—Ä–µ—Å–∞ –≤—Å–µ—Ö —Ç—Ä—ë—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
uint64 nonce = vm.getNonce(deployer);
address predictedFeeVault = computeCreateAddress(deployer, nonce);
address predictedOracleAgg = computeCreateAddress(deployer, nonce + 1);
address predictedRBTCSynth = computeCreateAddress(deployer, nonce + 2);

// STEP 2: –î–µ–ø–ª–æ–∏–º FeeVault —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º Oracle
FeeVault feeVault = new FeeVault(
    predictedOracleAgg,    // oracle = –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π Oracle Aggregator
    payable(feeCollector)  // feeCollector = –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è –∫–æ–º–∏—Å—Å–∏–π
);

// STEP 3: –î–µ–ø–ª–æ–∏–º OracleAggregator —Å —Ä–µ–∞–ª—å–Ω—ã–º FeeVault –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º RBTCSynth
OracleAggregator oracle = new OracleAggregator(
    predictedRBTCSynth,    // predicted synth address
    address(feeVault),     // actual feeVault address
    FEE_POLICY,           // existing working feePolicy
    committee,            // committee (deployer)
    MIN_CONFIRMATIONS,    // minConf
    MAX_FEE_PER_SYNC      // maxFeePerSync
);

// STEP 4: –î–µ–ø–ª–æ–∏–º RBTCSynth —Å —Ä–µ–∞–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º Oracle
RBTCSynth rbtcSynth = new RBTCSynth(address(oracle));
```

## üîß –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Mainnet

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ forge —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
forge --version

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–µ–ø–ª–æ–µ—Ä–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ!)
export PRIVATE_KEY="your_mainnet_private_key_here"

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å RPC URL –¥–ª—è Mainnet
export RPC_URL="https://mainnet.infura.io/v3/your_key"
# –∏–ª–∏
export RPC_URL="https://eth-mainnet.alchemyapi.io/v2/your_key"
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è Mainnet

–û–±–Ω–æ–≤–∏—Ç—å `contracts/script/AtomicDeployFixed.s.sol`:

```solidity
// Mainnet Configuration
uint256 constant CHAIN_ID = 1; // Ethereum Mainnet

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π FeePolicy –∏–ª–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–æ–≤—ã–π
address constant FEE_POLICY = 0x...; // Mainnet FeePolicy address

// Mainnet –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
uint256 constant MIN_CONFIRMATIONS = 6; // –ë–æ–ª—å—à–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
uint256 constant MAX_FEE_PER_SYNC = 0.01 ether; // –†–∞–∑—É–º–Ω—ã–π –ª–∏–º–∏—Ç –∫–æ–º–∏—Å—Å–∏–π
```

### 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–ø–ª–æ–π

```bash
# –î–µ–ø–ª–æ–π –≤ Mainnet (–ë–ï–ó --broadcast –¥–ª—è dry run)
forge script contracts/script/AtomicDeployFixed.s.sol:AtomicDeployFixed \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY

# –ï—Å–ª–∏ –≤—Å—ë –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π
forge script contracts/script/AtomicDeployFixed.s.sol:AtomicDeployFixed \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --broadcast \
  --verify
```

### 4. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–æ–±–Ω–æ–≤–∏—Ç—å –∞–¥—Ä–µ—Å–∞)
node test-complete-atomic-system.js
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚úÖ FeeVault ‚Üí Oracle:        OK
‚úÖ Oracle ‚Üí Synth:           OK  
‚úÖ Oracle ‚Üí FeeVault:        OK
‚úÖ Oracle ‚Üí FeePolicy:       OK
‚úÖ Synth ‚Üí Oracle:           OK
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –¥–µ–ø–ª–æ—è –≤ MegaETH

### –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ –∞–¥—Ä–µ—Å–∞ (MegaETH Testnet):
- **FeeVault:** `0x9C0Bc4E6794544F8DAA39C2d913e16063898bEa1`
- **OracleAggregator:** `0x74E64267a4d19357dd03A0178b5edEC79936c643`  
- **RBTCSynth:** `0x4BC51d94937f145C7D995E146C32EC3b9CeB3ACC`
- **FeePolicy:** `0xc10fD3a2DF480CFAE8a7aBC2862a9c5724f5f4b4` (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω)

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞:
- ‚úÖ –í—Å–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —Å–æ–≤–ø–∞–ª–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏
- ‚úÖ –í—Å–µ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
- ‚úÖ Oracle Aggregator –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å `spendFrom()` –Ω–∞ FeeVault
- ‚úÖ –û—à–∏–±–∫–∞ `0x1bc2178f (NotOracle)` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –º–∞–π–Ω–∏–Ω–≥—É RBTC —Ç–æ–∫–µ–Ω–æ–≤

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –û–±–Ω–æ–≤–∏—Ç—å Oracle Server
```bash
# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Oracle —Å–µ—Ä–≤–µ—Ä–∞ —Å –Ω–æ–≤—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
ssh user@oracle-server "sed -i 's/OLD_ORACLE_ADDRESS/NEW_ORACLE_ADDRESS/g' oracle-server.js"
ssh user@oracle-server "pm2 restart oracle-server"
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å Frontend
```typescript
// app/lib/contracts.ts
export const CONTRACTS = {
  CHAIN_ID: 1, // Mainnet
  FEE_VAULT: '0x...', // –ù–æ–≤—ã–π FeeVault
  ORACLE_AGGREGATOR: '0x...', // –ù–æ–≤—ã–π Oracle Aggregator
  RBTC_SYNTH: '0x...', // –ù–æ–≤—ã–π RBTCSynth
  FEE_POLICY: '0x...', // FeePolicy (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω)
}
```

### 3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –û–±–Ω–æ–≤–∏—Ç—å –∞–¥—Ä–µ—Å–∞ –≤–æ –≤—Å–µ—Ö docs —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
- –û–±–Ω–æ–≤–∏—Ç—å README.md
- –û–±–Ω–æ–≤–∏—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ Git
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏ –¥–ª—è Mainnet –¥–µ–ø–ª–æ—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ tesnet –ø–µ—Ä–µ–¥ Mainnet
- –î–µ–ª–∞—Ç—å backup –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### –ì–∞–∑ –∏ –∫–æ–º–∏—Å—Å–∏–∏
- –ê—Ç–æ–º–∞—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π —Ç—Ä–µ–±—É–µ—Ç ~1.9M –≥–∞–∑–∞
- –í Mainnet —É—á–∏—Ç—ã–≤–∞—Ç—å –≤—ã—Å–æ–∫–∏–µ —Ü–µ–Ω—ã –Ω–∞ –≥–∞–∑
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π –≤ –ø–µ—Ä–∏–æ–¥—ã –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ç–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–ª–Ω—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –º–∞–ª—ã–º–∏ —Å—É–º–º–∞–º–∏ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ê—Ç–æ–º–∞—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π —Ä–µ—à–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ ReserveBTC, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã. –ú–µ—Ç–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –≤ Mainnet.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É `NotOracle()` –æ—à–∏–±–æ–∫
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å Oracle —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

---
*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –≤ MegaETH Testnet 2025-09-05*